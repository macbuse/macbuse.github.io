\documentclass[12pt,a4paper]{amsart}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}

\usepackage[all,cmtip]{xy}

\usepackage{hyperref}

\usepackage{float}
\usepackage{subfig}


%\usepackage[dvipdfmx]{graphicx}
\usepackage{graphicx}
\usepackage{caption}
%\usepackage[nobysame, alphabetic]{amsrefs}
%\usepackage{here}
%\usepackage{showkeys}
\newcommand{\modif}{$\clubsuit$}
\newtheorem{thm}{Theorem}[section]
\newtheorem{defn}[thm]{Definition}
\newtheorem{coro}[thm]{Corollary}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{lem}[thm]{Lemma}
%\theoremstyle{definition}
\newtheorem{rmk}[thm]{Remark}
\newtheorem{cond}[thm]{Condition}

%CB defs
\def\rh{\phi_h}
\def\rv{\phi_v}

\def\HH{\mathbb{H}}
\def\GG{\mathbb{G}}
\def\dHH{\partial \mathbb{H}}
\def\hd{\hat{\delta}}
\def\ha{\hat{\alpha}}
\def\haa{\ha \cup \{\alpha^+,\alpha^-\}}

\def\im{\mathrm{Im}\,}
\def\re{\mathrm{Re}\,}
\def\oo{\HH / \Gamma_0(2)} 
\def\ooo{\HH / \Gamma_0(3)} 
\def\g2{\Gamma(2)}
\def\go2{\Gamma_0(2)}
\def\ah{\Gamma_0^t(2)}
\def\oot{\HH / \ah} 
\def\xx{\HH/\g2}


\def\ZZ{\mathbb{Z}}
\def\CC{\mathbb{C}}
\def\RR{\mathbb{R}}
\def\QQ{\mathbb{Q}}
\def\NN{\mathbb{N}}

\def\tt{\Sigma_{1,1}}

\def\fp{\mathbb{F}_p}
\def\aut{\text{Aut}(\F2)}
\def\gl2{\mathrm{GL}(2, \ZZ)}
\def\sl2{\mathrm{SL}(2, \ZZ)}
\def\slc{\mathrm{SL}(2, \CC)}

\def\oi{\Gamma.\{i\}}

\def\gg{\mathcal{G}_n}
\def\ggp{\mathcal{G}_p}

\def\isom{\mathrm{isom}(\HH)}

\def\isomH{\text{isom}^+(\HH)}
\def\tr{\text{tr\,}}


\def\GI{\mathbb{Z}[i]}
\def\hc{\CC \setminus \GI}



\title{Geodesics and values of quadratic forms}

 \author[McShane]{Greg McShane}
 % \author[Vlad]{Vlad Sergesciu}
\address{Institut Fourier 100 rue des maths, BP 74, 38402 St Martin d'H\`eres cedex, France}
\email{mcshane at univ-grenoble-alpes.fr}




\begin{document}

\maketitle

\section{Introduction}

% \[
% \xymatrix{
% \GG \ar[r]^{F} \ar[d]_{gg} & \GG \ar[d]^{gg} \\
% \fp \ar[r]^{f} & \fp
% }
% \]	

Recall
that $\bar{m}\in \fp$ is a \textit{quadratic residue} iff
there is $\bar{x}\in \fp $ such that $\bar{x}^2 = \bar{m}$.
The first results concerning quadratic residues were stated by
Fermat. 

Determining the primes $p$ for which a particular $m$ is a quadratic
residue is a fundamental problem, studied by Fermat, Euler, Legendre
and Gauss. The case of $-1$ is particularly famous:

\begin{thm}\label{triv}
Let $p$ be a prime then the equation
$$\bar{x}^2 = -1$$
admits a solution in $\fp$ iff 
$p =2$ or $p-1$ is a multiple of $4$.
\end{thm}

Classically, as observed by Euler this result is the first step in proving an a priori stronger result:


\begin{thm}[Euler]\label{main}
Let $p$ be a prime then the equation
$$x^2 + y^2 = p $$
has a solution in integers  iff  $p =2$ or $p-1$ is a multiple of $4$.
\end{thm}

\noindent
So there are two parts to Euler's proof:
\begin{enumerate}
	\item the \textit{reciprocity step} which consists of
		proving Theorem \ref{triv}. This tells us
		that there are $a,k \in \mathbb{N}$ with $kp = a^2 +1^2$.
	\item the {descent step} which consists of showing
		there is a  monotonically decreasing sequence
		$k_i \in \mathbb{N}$ with $k_ip = a_i^2 +b_i^2$
		that terminates with some $k_i=1$.
\end{enumerate}

There are myriad proofs of these theorems but the approach initiated
by Heath-Brown in \cite{heath} has inspired many admirers if not
imitators \cite{generalov, jackson,northshield, dubach}, probably
The most elegant of these is probably Dolan's proof \cite{dolan}.
but see Elsholtz's very nice account \cite{elsholtz} of the methd in
general. In some sense this manuscript is a companion to Elsholtz's
where, instead of looking at the number theory as combinatorics, we
work in an explicitly geometric context. As such we refer the reader
to Elsholtz for historical perspective and the like. 


\subsection{Involutions}

The Heath-Brown proof is intriguing as it appears so different from
Euler's method in that it avoids both reciprocity and descent.
The essential ingredients in the Heath-Brown paper are
a finite set $X$ equipped with a pair of involutions such that:


\begin{itemize}
	\item Any fixed point of the one of the involutions,
		should it exist, is a solution of the equation;
	\item The other involution has a unique fixed point which is easy to compute.
\end{itemize}

The existence of the unique fixed point of the second involution
allows one to conclude that the set $X$ has an odd number of elements
and so that any involution has a fixed point.


Generalov \cite{generalov} has given a proof (see also Elsholtz \cite{elsholtz}) in the style of Zagier of one part of
another result conjectured by Fermat:

\begin{thm}\label{case m equals 2}
Let $p$ be a prime then the equation
$$x^2 + 2y^2 = p $$
has a solution in integers  
iff  $p =2$ or $p$ is congruent to $1$ or $3$ mod $8$.
\end{thm}

\noindent
Obviously the case $p=2$ is trivial.
Of the other two cases 
both Generalov and Elsholtz give proofs for $p = 3 \mod 8$ 
though $p=1 \mod 8$ resisted them.
We will give an entirely geometric proof of this result and a
"hybrid" proof of the other case.

Our hybrid proof is based on an analogue of Theorem \ref{triv} (see
the discussion in Section \ref{extending} for details):

\begin{lem}\label{analogue for -2}
Let $p$ be a prime then 
$-2$ is a quadratic residue, 
iff  $p$ is congruent to $1$ or $3$ mod $8$.
\end{lem}


\subsection{Arcs on a punctured surface}

What inspired us was the insistence of V Sergesciu that one could
understand quadratic forms like $x^2 +y^2$ and more generally $x^2 + my^2$
from a geometric point of view (see Cox's book \cite{cox} for the classical approach).
Certainly Conway \cite{conway} has developed a geometric theory of 
the values of a quadratic form using what he calls the
\textit{topograph of a quadratic form}
(see Hatcher's book \cite{hatcher} for a complete account with back
ground)
he is in the main concerned with indefinite forms.

Our approach, like Conway's, is based on properties of $\Gamma$ acting on $\mathbb{H}$.
Whilst the finite set $X$ employed in the variations of
Heath-Brown's method is readily described in terms of solutions
in positive integers to some equation (see  Dolan \cite{dolan}) 
the geometric interpretation of our set $X$ requires some knowledge
of the elementary theory of Fuchsian groups acting on $\mathbb{H}$ and
its ideal boundary $\partial \mathbb{H}$ which we will now sketch.
The reader, unfamiliar with the relationship between hyperbolic
geometry and number theory,
should consult Springborn's articles \cite{springborn1, springborn2}
where a dictionary between geometric and number theoretic notions is presented.

Let $\Gamma = \sl2$ then it admits a action on $\mathbb{H}\cup \dHH$ via
$$
\begin{pmatrix} a&b\\c&d \end{pmatrix} \in \Gamma,
z \mapsto \frac{az + b}{cz + d}.

$$

The restriction of this action to $\mathbb{H}$ is properly
discontinuous but not free and the quotient is a non compact singular surface
called the \textit{modular surface} $\mathbb{H}/\Gamma$.
The $\Gamma$-orbit of $\inty$ is exactly the extended rationals $\mathbb{Q}\cup \{\infty\}$.
Let $G<\Gamma$ be a finite index subgroup, we will be concerned with involutions of the cover
$\mathbb{H}/G\rightarrow \mathbb{H}/\Gamma$ and their actions on the arcs on the cover.
Evidently $\mathbb{H}/G$ is non compact and has a finite number of
ends called \textit{cusps} which are in 1-1 correspondence 
with  $G$-orbits of $\mathbb{Q}$.
We call \textit{arc} the image on $\mathbb{H}/G$ of any Poincaré geodesic joining  a pair of distinct rationals.
As such an arc is a complete geodesic on a $\mathbb{H}/G$ with both
of its ends ``terminating" at cusps, 
so it has infinite length but if we only consider the portion outside some
family of sufficiently small uniform neighbors of the cusps then
this will be finite. 
The $\lambda$-length
of the arc is exponential of half the length of this finite portion.
Whilst this definition works well for simple arcs, 
since the portion of the arc
outside the uniform cusp region is connected, more care is needed if the arc is not simple.
Since Penner \cite{bob} first defined $\lambda$-length 
there has been much work on their applications

\begin{itemize}
	\item Weil-Peterson volume of moduli space \cite{bob}
	\item cluster algebras \cite{fomin}.
	\item Conway-Coxeter frieze patterns \cite{frieze}.
\end{itemize}
Our approach (see Section \ref{inversions} for a sketch) to Fermat's theorem \cite{vlad} depended on determining the number of arcs on a surface
of $\lambda$-length p.
Fortunately, the surface $\xx$ we were lead to study is  probably
the easiest surface to count arcs on.

\begin{thm}\label{g2 arcs}
	Let $p$ be a prime number then the number of arcs of
	$\lambda$-length p on the surface
	$\xx$ is $3(p-1)$.
\end{thm}


% \noindent
% As we shall see in Section \ref{}, this result essentially implies
% Theorem \ref{main}.

 \begin{figure}[ht]
\begin{center}
\includegraphics[scale=.3]{3sphere.png} 
\end{center}
\caption{The surface $\xx$. The dotted lines are arcs one of which
is a loop of $\lambda$-length 2, 
and the other,
which joins cusps labelled $0$ and $1$, has $\lambda$-length 1.}
\label{3sphere}
\end{figure}

The surface  $\xx$ is not compact and has three cusps which
are naturally associated with $0,1,\infty \in \partial \mathbb{H}$.
This is a manifestation of the fact that $\g2$ acts on the extended
rationals $\mathbb{Q} \cup \{\infty\}$ preserving parity.
By \textit{parity} we mean one
of the three classes obtained by taking the 
numerator and denominator  of  a fraction $\frac{a}{c}$ modulo 2
where, by convention, $\infty = \frac{1}{0}$.
The proof of Theorem \ref{g2 arcs} is basically the observation that the Poincaré geodesics
of $\mathbb{H}$ (vertical lines) ending at $2k / p\n \mathbb{Q},\, 1\leq k \leq
p-1$ is a set of lifts for the arcs joining the cusps labeled $0$ and
$\infty$ on $\xx$ (see Figure \ref{3sphere}.)

Actually $\xx$ is a degree 6 cover of the modular surface
$\mathbb{H}/\Gamma$. 
Unfortunately this covering is ramified at 2 points and
the projection of an arc on $\xx$ may or may not be an arc in the
quotient.
One problem is that an arc may be invariant by some involution
in the covering group $\Gamma / \Gamma(2)$ and as a consequence connects the cusp on
$\mathbb{H}/\Gamma$ to a ramification point.


% 	Let $p$ be a prime number then the number of arcs of
% 	$\lambda$-length p on the modular surface
% 	$\mathbb{H}/\Gamma$ is 
	
% 	\begin{itemize}
% 		\item p-1 if 4 does not divide p-1,
% 		\item p-2 if p=2 or 4 divides p-1.
% 	\end{itemize}

% 	% \begin{itemize}
% 	% 	\item p-1 if p-1 and  12 are coprime
% 	% 	\item p-3 if p is of the form $12k +1$
% 	% 	\item p-2 if p is of the form $12k+7$, $12k
% 	% 		+5$ or $12k + 9$
% 	% \end{itemize}

% \end{thm}


Evidently the arcs on $\xx$ fall into two families:
\begin{itemize}
	\item arcs that join distinct cusps. 
	\item arcs that have both ends at the same cusp
\end{itemize}
We will refer to the second kind of arc as a \textit{loop}
(see Figure \ref{3sphere}).
Amusingly one can characterise loops using $\lambda$-length.
\begin{lem}\label{length parity}
	An arc on $\xx$ is a loop if and only if its
	$\lambda$-length is even.
\end{lem}


\subsection{Representing arcs as matrices}
To give a proof of Lemma \ref{length parity}
we clearly need an algebraic characterisation of $\lambda$-lengths.
It is fortunate then that computing the $\lambda$-length of an arc $\alpha$ on $\xx$
with respect to the canonical choice of cusp regions
is relatively simple.
One considers a lift $\hat{\alpha}\subset \mathbb{H}$ of the arc.
This is a Poincaré geodesic joining a pair of distinct rationals
$a/c,b/d \in \mathbb{Q}$ and the $\lambda$-length is just
the absolute value of the determinant of the matrix
$$ 
 \begin{pmatrix} a & b \\ c & d \end{pmatrix}.
$$
Now Lemma \ref{length parity}
is immediate, for if $\frac{a}{c}$ and $\frac{b}{d}$
have the same parity then reducing modulo the 
matrix modulo $2$ then both columns are the same
and so the parity of the determinant is $0$.
Conversely, if the parity of the determinant is $0$
then columns  modulo 2 are linearly dependent over
$\mathbb{Z}/2\mathbb{Z}$ and this means they have the same parity
and so represent the same cusp on $\xx$.

In what follows we use matrices over $\mathbb{Z}$,
up to an equivalence relation denoted $\sim$,
to represent unoriented arcs.
Explicitly  for a pair of invertible matrices 
$$ 
 \begin{pmatrix} a & b \\ c & d \end{pmatrix} \sim
 \begin{pmatrix} a' & b' \\ c' & d' \end{pmatrix}.
$$
iff $\{\frac{a}{c}, \frac{b}{d}\} = \{\frac{a'}{c'}, \frac{b'}{d'}\}
\subset \mathbb{Q}\cup \{\infty\}$
. 
We think of the matrices 
$$
 \begin{pmatrix} 1 & k \\ 0 & p \end{pmatrix},
 \begin{pmatrix} k & 1 \\ p  & 0 \end{pmatrix}.
$$
as representing an arc joining $\infty$ to $k/p$
but with opposite orientations.

This matrix representation will prove very convenient when later
(see Section \ref{actions agree})
have to check that two arcs are in the same $G$-orbit for some $G <
\sl2$ and so project to the same arc on the quotient surface
$\mathbb{H}/G$.
% It is easy to see that $\lambda$-length is well defined for a
% equivalence class of matrices.

\subsection{Philosophy}

Let $\Gamma = \sl2$ then it admits a action on $\mathbb{H}\cup \dHH$ via
$$
\begin{pmatrix} a&b\\c&d \end{pmatrix} \in \Gamma,
z \mapsto \frac{az + b}{cz + d}.

$$

The action decomposes into two quite different pieces:
\begin{enumerate}
	\item the restriction of this action to $\mathbb{H}$
		is properly discontinuous but not free and the quotient is
		a singular surface called the \textit{modular
		surface} $\mathbb{H}/\Gamma$
	\item	the stabiliser of $i\in \mathbb{H}$ is non
		trivial and is generated by $z\mapsto -1 / z$
	\item the action on $\dHH$ admits dense orbits for
		example the orbit of $\infty$ is exactly
		$\mathbb{Q}\cup \{\infty\}$
	\item the stabiliser of $\infty \in \dHH$ is the
		infinite cyclic group generated by $z\mapsto
		z+1$

	\item $F = \{z\in \mathbb{H}, \mathrm{Im}\,z > 1\}$ is
		invariant under the group $\langle z \mapsto
		z+1 \rangle$  and embeds in
		$\mathbb{H}/\Gamma$ as a \textit{cusp region}.

\end{enumerate}

Let $G<\Gamma$,
we will be concerned with involutions of the cover 
$\mathbb{H}/G\rightarrow \mathbb{H}/\Gamma$.
The actual starting point for our interest in this was a series of observations
concerning $\lambda$-lengths of simple arcs on a once punctured
torus equipped with a hyperbolic structure.
The canonical  example of such a surface is the quotient $\HH/\Gamma'$
where $\Gamma' < \Gamma = \sl2$ is the commutator subgroup. 

% An important
% feature of a punctured surface is that it admits \textit{uniform
% cusp regions} (see \cite{Shimizu}) that is there is a neighborhood of each puncture, or more properly cusp, isometric to 
% $\{z\in \mathbb{H}, \mathrm{Im}\,z > 1\}/\langle z \mapsto z+1 \rangle.$  


The  torus $\mathbb{H}/\Gamma'$ can
be obtained from a pair of ideal triangles by "gluing" and the sides
of the ideal triangles form a triple of complete simple geodesics on
the surface. The corners of the triangles glue up to a neighborhood
of the puncture. We define an \textit{arc} to
be any complete geodesic on a punctured surface with both of its
ends terminating at cusps. The three sides of the ideal triangle(s)
above form a triple of disjoint simple arcs. Each of these arcs has
infinite length but if we only consider the portion outside the
uniform cusp region then its length is finite. The $\lambda$-length
of the arc is exponential of half the length of this finite portion.
Whilst this definition works well for simple arcs, since the portion of
the arc
outside the uniform cusp region is connected, more care is needed if
the arc is not simple.
It is a remarkable fact that for any embedded ideal triangle the
triple of $\lambda$-lengths $(x,y,z)$ satisfy the Markoff cubic:
\begin{equation}
	x^2 + y^2 + z^2 - xyz = 0.
\end{equation}
Suppose now that $p$ is a prime that divides $z$ 
then reducing modulo $p$ one has $\bar{x}^2 + \bar{y}^2 = 0$ which
leads naturally to considering Fermat's theorem above
and in particular Button's results on the Frobenius unicity
conjecture \cite{button}.

Since Penner \cite{bob} first defined $\lambda$-length 
there has been much work on their applications

\begin{itemize}
	\item Weil-Peterson volume of moduli space \cite{bob}
	\item cluster algebras \cite{fomin}.
	\item Conway-Coxeter frieze patterns \cite{frieze}.
\end{itemize}
O
In some sense we adopt the same approach to (positive definite) integer quadratic forms as
Penner in \cite{bob} (see also \cite{springborn1}.)
Such a
quadratic form is associated to an involution of the upper half
space $\mathbb{H}$: 
\begin{itemize}
	\item if the form is (positive) definite then the involution is orientation preserving 
	\item if the form is indefinite then the involution is
		orientation reversing 
\end{itemize}

What will be of interest to us here is the automorphism 
that an involution induces on a surface $\mathbb{H}/G$
where $G$ is some group that our involution normalises.

We will show that questions concerning the values of the quadratic form $x^2
+ m y^2$ can be interpreted of terms of arcs on the surface
$\mathbb{H}/\Gamma^t_0(m)$ where
$\ah$ is the 
\textit{anti Hecke congruence group}:
$$ \Gamma^t_0(m) := \left \{ \begin{pmatrix} a & b \\ c & d \end{pmatrix} = 
\begin{pmatrix} 1 & 0 \\ * & 1 \end{pmatrix} \mod m \right \} <
\Gamma(m).$$
This group is 
% the inverse image under the reduction morphism
% of the lower triangular matrices
normalised by the involution $z\mapsto -\frac{m}{z}$
which fixes $i\sqrt{m}$.
For $\Gamma^t_0(2)$  we will work through all the calculations and
the geometry in detail.
This will allow us to give a geometric proof of the fact thatany
prime congruent to $3$ modulo 8 is represented by $x^2 + 2y^2$.
Of course, it is also true (see Lemma \ref{analogue for -2})
	any
prime congruent to $1$ modulo 8 is represented by $x^2 + 2y^2$ but
unfortunately we are unable to give a purely geometric proof of
this.




\section{Klein four group and the Burnside Lemma}

We give a proof of Theorem \ref{triv} using the Burnside Lemma.


Recall that if $G$ is  a group acting on a finite set $X$ then the Burnside Lemma says
\begin{equation}\label{burnside}
|G| |X/G| = \sum_{g} |X^g| 
\end{equation}  
where, as usual, 
 $X^g$ denotes the set of fixed points of the element $g$ 
 and $X/G$  the orbit space.

Let $p\neq 2$,  $X = \fp^*$ and $G$ be the group generated by the two involutions
\begin{eqnarray*}
x & \mapsto -x \\
x & \mapsto 1/x.
\end{eqnarray*}
The group  $G$ has exactly four elements namely:
\begin{itemize}
\item the trivial element which has  $p-1$ fixed points
\item $x\mapsto -x$ which has no fixed points 
\item  $x\mapsto 1/x$ has exactly two fixed points namely $1$ and $-1$.
\item  $g:x \mapsto -1/x$ is the remaining element and the theorem is equivalent to the existence of a fixed point for it.
\end{itemize}
Note that since $\fp$ is a field 
$|X^g| = \sharp \{x^2 = -1, \, x\in \fp^* \}$
is either $0$ or $2$.
Now for our choice of $X$ and $G$ equation (\ref{burnside}) yields
\begin{equation}
4 |X/G|   = (p-1) + 2 + |X^g|.
\end{equation}  
The LHS is always divisible by $4$ so the  RHS is too and
it follows from this that
$$ |X^g|. = \left\{  \begin{array}{ll}
		0 & \text{if }(p-1) =  2 \mod 4 \\
2 & \text{if }(p-1) =  0 \mod 4 \\
\end{array}
\right.
$$
This proves Theorem \ref{triv}.

\subsection{Extending}\label{extending}

Thus we have shown that $-1$ is a quadratic residue modulo $p$ if
$p$ is of the form $4k+1$. 
It is natural to consider the other questions considered by Fermat:
namely for which values of $p$ are $-2$ and $-3$ residues?


In fact  $-2$  is a residue if $p$ is $2$ or of the form $8k+1$ or
$8k+3$ (Lemma \ref{analogue for -2}).
Showing this in the spirit of Heath-Brown requires one to consider a group generated by the involutions 
\begin{eqnarray*}
x & \mapsto -x \\
x & \mapsto 2/x.
\end{eqnarray*}
One immediately sees that things are more complicated as the
second involution has fixed points if and only if $2$ is a residue
whereas $x\mapsto 1/x$ always had exactly two fixed points.
Thus there are two cases:
\begin{itemize}
	\item $p=8k+1$ and both $2$ and $-2$ are residues
	\item $p=8k+3$ and $-2$ is a residue but $2$ is not.
\end{itemize}
To prove this second assertion 
one must show that 
$x  \mapsto 2/x$ has no fixed point
% so $2$ is not a residue 
so that, by Burnside,
$x  \mapsto -2/x$ has two fixed points 
both of which are square roots of $-2$.
Thus one must show that the only solution of the associated diophantine equation 
$$np = x^2 - 2y^2,$$
is the trivial solution $n=x=y=0$.
Now using the fact that 
$x^2 - 2y^2$ 
is the norm of $x+y \sqrt{2}\in \mathbb{Z}[\sqrt{2}]$ which is a
euclidean ring for this norm,
one reduces to considering just the solutions of 
$$p = x^2 - 2y^2.$$
Finally, 
% by considering congruence classes modulo 8,
one concludes by showing that if $x,y$ are integers then
$x^2 - 2y^2$ never takes the value $3 \mod 8$.

\subsection{The case $p=11$}

The first case of genuine interest in understanding 
$x\mapsto -2/x$ is that of $\mathbb{F}_{11}^*$.
Evidently, $11 = 3^2 + 2\times 1^2$ so that 
$\bar{3}$ and $-\bar{3} = \bar{8}$ are the fixed points of the involution.


The reduction homomorphism $x\mapsto \bar{x}$
allows one to identify the elements of $\fp$
with the equivalence classes that constitute
 the quotient $\mathbb{Z}/p \mathbb{Z} $.
It is usual  
to choose the integers $0,1, 2\ldots p-1$ as representatives for the
latter, 
however, we shall find it convenient to work with
another set of representatives, namely the even integers 
$0, 2, 4 \ldots 2p -2$.
Using the euclidean algorithm to compute $\bar{x}^{-1} \in \mathbb{F}_{11}$
we have the following table:
\vspace{.1in}
\begin{center}
	
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|}
	\hline
	${x}$ & 12 & 2 & 14 & 4 & 16 & 6 & 18 & 8 & 20 & 10 \\
	\hline
	$\bar{x}$ & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\

	\hline
	$\bar{x}^{-1}$& 12 & 6 & 4 & 14 & 20 & 2 & 8 & 18 & 16 & 10 \\
	\hline
$-2\bar{x}^{-1}$& 20 & 10 & 14 & 16 & 4 & 18 & 6 & 8 & 12 & 2 \\
	\hline
\end{tabular}
\end{center}
\vspace{.1in}
One notes that there are two fixed points of $-\bar{x} \mapsto
-2\bar{x}^{-1}$ namely $\overline{14}=\bar{3}$ and $\bar{8}$.


\section{Counting sums of squares}

We count solutions for the diophantine problem $n = c^2 + d^2$ in two ways:
\begin{itemize}
	\item Firstly by showing that solutions are
		naturally associated to the  $\Gamma$
		orbit of $i$;
	\item Secondly by counting arcs of $\lambda$-length n.
\end{itemize}

We extend these results to counting solutions of $n = mc^2 + d^2$
using the $\Gamma$-orbit of $i\sqrt{m}$.


\subsection{From solutions to $\Gamma$-orbits}

The transformation $z \mapsto z + 1$ generates an infinite cyclic
group acting on $\mathbb{H}$.
The standard fundamental domain for this group is an infinite strip,
which we will refer to as the \textit{fundamental strip},
consisting of all the $z\in \CC$ such that 
the real part is between $0$ and $1$.

\begin{lem} \label{counting squares}
Let $n\geq2$ be an integer.
The number of  ways of writing $n$  as a  sum of squares
$$n = c^2 + d^2$$
with $c,d$ coprime integers
is equal to the number of points
of $\oi$, 
the $\sl2$  orbit of $i$,
in the fundamental strip such that the imaginary part (euclidean height) is $\frac{1}{n}$.
\end{lem}
Note that we are counting $c^2 + d^2$ and $d^2 + c^2$ 
as \textit{different} representations of $n$.

\proof  Suppose there is a point $w$
verifying the hypotheses, in particular

$$w = \frac{ai + b}{ci + d},\, 
\text{ for some } \begin{pmatrix} a&b\\c&d
\end{pmatrix} \in \Gamma.$$
Then one has:
\begin{equation}\label{imaginary height}
\frac{1}{n}= \im w = \im  \left (\frac{ai +b}{ci+d } \right)
= \frac{\im i} {c^2 + d^2},
\end{equation}
so $n = c^2 + d^2$ as claimed.

Conversely if $c,d$ are coprime integers
such that $n=c^2 +d^2$
 then there exists $a,b$ such that
 $$ad - bc = 1 \Rightarrow  
A =  \begin{pmatrix}
 a & b \\
 c & d
 \end{pmatrix} \in \Gamma.
$$
%The real part of $w = \frac{ai +b}{ci+d }$ is
%$$ac + bd = (a,b).(c,d),$$
%and
By applying a suitable iterate of the parabolic transformation 
$z \mapsto z + 1$, if necessary 
one can choose $w$ such that $0 \leq \text{Re\,} w < 1$.

\hfill $\Box$

\subsection{From $\Gamma(2)$ orbits to arcs}

Suppose that $n$ can be written as a sum of squares $c^2 +d^2$
and $w$ is the corresponding point in the fundamental strip then we
can associate a Poincaré geodesic to $w$ in a natural way: 
we simply take the vertical line that passes through $w$.
This geodesic joins two points in the ideal boundary of $\mathbb{H}$
namely $\infty$ and $\frac{ac + bd}{n}\in \mathbb{Q}$.
Penner's $\lambda$-length
This geodesic projects to an arc on the surface $\xx$
and, using the definition above, its $\lambda$-length is $n$.
If $n$ is not even then this arc is not a loop
and so joins a pair of distinct cusps $\infty$ and $1$ say.


\subsection{Real part and reduction modulo $n$}
\label{real part}

By a similar argument as for Lemma \ref{counting squares}
one has a slightly more general result:

\begin{lem} \label{counting quadratic form}
Let $n\geq2$ be an integer and $m < n$ a square free integer.
The number of  ways of writing $n$  as a  sum of squares
$$n = mc^2 + d^2$$
with $c,d$ coprime integers
is equal to the number of points
of $\Gamma.\{i\sqrt m\}  $
the $\sl2$  orbit of $i\sqrt m$,
in the fundamental strip at euclidean height $\frac{\sqrt m}{n}$.
\end{lem}
\noindent
Thus the imaginary part of
$w = \left (\frac{ai\sqrt{m} +b}{ci\sqrt{m}+d } \right)$
arises naturally in relation to counting the number of ways of
representing an integer $n$ as $mc^2 + d^2$.
Now the real part of $w$ is
$$\frac{mac +bd}{mc^2+d^2 } ,$$
% and if the denominator is $n$ as before
% $mc^2 + d^2 = 0 \in \mathbb{Z} / n \mathbb{Z}$.
and it also plays and important role: 
it is a fraction whose denominator is $n$ and whose numeratoris nothing other than a
square root of $-\bar{m}$ in $\mathbb{Z} / n\mathbb{Z}$.
In Section \ref{lifting involutions}
we will give a converse to this result in certain cases,
showing how to ``lift" a square root in $\mathbb{Z}/n \mathbb{Z}$ to a solution of $mc^2
+ d^2 = n$.


\begin{lem}\label{square root -m}
Let $a,b,c,d,m\in \mathbb{Z} / n\mathbb{Z}$ and suppose that they satisfy
the relations

\begin{eqnarray}
	mc^2 + d^2 &=& 0\\
	ad -bc &=& 1 \label{determinant}.
\end{eqnarray}
Then
% \begin{equation}
$$	(mac + bd)^2 = -m.$$
% \end{equation}

\end{lem}

\proof 

To prove this begin by noting that:
\begin{eqnarray*}
	(mac + bd)^2 &=& (ma^2)(mc^2) + b^2d^2 + 2m(abcd) \\
	m(ad-bc)^2 &=& (ma^2)d^2
	+ b^2(mc^2)  - 2m(abcd) = m
\end{eqnarray*}
% using (\ref{determinant})
and adding these:
$$
	(mac + bd)^2 + m = (ma^2)(mc^2+d^2) + b^2(mc^2 + d^2
	) = 0.
$$
\hfill $\Box$

\section{Inversions and the proof of Theorem
\ref{main}}\label{inversions}

We present a sketch of the geometric proof given in our previous
work  with Sergiescu\cite{vlad}.

Let $\mathbb{H}$ denote the Poincaré upper half plane and $\dHH$
its ideal boundary ie $\mathbb{R}\cup \{\infty\}$.
Recall that an \textit{inversion} is an orientation reversing
isometry of $\mathbb{H}\cup \dHH$. 
A Poincaré geodesic is either a vertical line or a semicircle
orthogonal to $\mathbb{R}$.
In both cases it is uniquely determined by its endpoints in the
ideal boundary.
To each Poincaré geodesic is associated a unique inversion which fixes it pointwise. 
The inversion
$\rh: z\mapsto -\bar{z}$ fixes $0$ and $\infty$ 
and so the geodesic joining them.
The group of isometries acts transitively on pairs of distinct
points $a,b \in \partial \mathbb{H}$ and so
there is an inversion that fixes the geodesic joining $a,b$ which is
in fact conjugate to $\rh$.
The inversion fixing $1,-1$ is easily seen to be
$\rv:z\mapsto \frac{1}{\bar{z}}$. 

Note that if $a,b$ are coprime integers then:
\begin{itemize}
	\item
The image of $\frac{a}{b}$ under $\rh$ is $-\frac{a}{b}$
and the $\lambda$-length of the geodesic joining them is $2|ab|$.

	\item
The image of $\frac{a}{b}$ under $\rv$ is $\frac{b}{a}$
and the $\lambda$-length of the geodesic joining them 
is $|a^2 - b^2|$.

\end{itemize}
It follows from these remarks that:
\begin{lem}\label{counting fixed points}
	Let $p>2$ be a prime then:
	
\begin{itemize} 

	\item There is no arc of $\lambda$-length $p$
		invariant under $\rh$.
	\item There are exactly two arcs of $\lambda$-length
		$p$ invariant under $\rv$;

\end{itemize}
\end{lem}
\proof 
The first part is easy because the $\lambda$-length of such an arc
is an even integer.
The second part follows from the fact that p factorises as
$$p = |(a-b)| |(a+b)|,$$
so up to permutation and change of sign $a,b$ are the integers
$\frac{1}{2}(p\pm1)$.

\hfill $\Box$

Our proof  of Theorem \ref{main} consists in noting that the above involutions normalise $\g2$
and so induce involutions of the quotient surface $\xx$.
We take $X$ to be the set of arcs of $\lambda$-length $p$ joining
the cusps marked $0$ and $\infty$ (see Figure \ref{g2 arcs})
and using Lemma \ref{counting fixed points} compute the terms in the
Burnside formula:
$$
4 |X/G|   = (p-1) + 2 + |X^g|,$$
	where $g$ is the involution induced by $z\mapsto -1 /
	z.$
We conclude that there is an arc that meets $\Gamma.\{i\}$ and obtain
$p$ as a sum of squares by Lemma \ref{counting squares}.




Later we will need to consider arcs invariant under the inversion
$z\mapsto \frac{m}{\bar{z}}$ for $m=2,3$.
This is an inversion in a semi circle with endpoints $\pm \sqrt{m}
\in \mathbb{R}$ .
If $\frac{a}{b}\in \mathbb{Q}$ then it is the endpoint of exactly
one  arc is invariant under this involution and the
of this arc is $\lambda$-length $|a^2 - m b^2|$.
For $m=2$ one can show 
% using congruences modulo $8$ 
that no invariant arc has $\lambda$-length congruent to $3$ or $5 \mod 8$.



\section{Congruence subgroups}

The Hecke congruence subgroup $\Gamma_0(N)$ of level $N$ is the subgroup of
$\Gamma = \mathrm{SL}(2,\ZZ)$ 
consisting of the matrices satisfying:
$$ \begin{pmatrix} a & b \\ c & d \end{pmatrix} = 
\begin{pmatrix} 1 & * \\ 0 & 1 \end{pmatrix} \mod N.$$

For $N=2$ this is generated by just two elements namely:
$$ P = \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix} \text{ and } Q=  \begin{pmatrix} 1 & 0 \\ 2 & 1 \end{pmatrix}.$$
The product $P^{-1}Q$ is an element of order $2$:
$$ P^{-1}Q = \begin{pmatrix} -1 & -1 \\ 2 & 1 \end{pmatrix}.$$
The quotient $\oo$ is a non-compact orbifold with two cusps,
corresponding to the cyclic groups generated by $P$ and $Q$, and a
single cone point corresponding to $P^{-1}Q$.
This orbifold admits a Klein four group as its group of
automorphisms
and the quotient by this group is a hyperbolic triangle with angles
$0, \pi/2, \pi/4$.

 \begin{figure}[H]
\begin{center}
\includegraphics[scale=.5]{hecke_fund_dom.png} 
\end{center}
\caption{On the left a fundamental domain for $\ah$ with side
pairings.  On the right the quotient surface $\oot$, the dark region
is a cusp region.}
\label{fundamental domain}
\end{figure}

The action of $\Gamma_0(2)$ on $\mathbb{Q}\cup \{\infty\}$ is not
transitive and there are two orbits.
Now $\Gamma(2) < \Gamma_0(2)  $ so each of these orbits is a union of
$\Gamma(2)$-orbits.
Since $\Gamma(2)$ preserves the parity of the numerator and
denominator of a fraction there are exactly three $\Gamma(2)$ orbits
corresponding to $\frac{0}{1} = 0,\, \frac{1}{1} = 1, \,
\frac{1}{0}=\infty$.
Now since $P$ maps $0$ to $1$:
$$\Gamma_0(2) \{0\} =   \Gamma(2) \{0\} \cup \Gamma(2) \{1\}.$$

In the previous section we considered the action of the involution
$x\mapsto -2/x$ on $\mathbb{F}_{p}^*$. It is natural to study the
action of the corresponding involution of $\mathbb{H}$ that is
$z\mapsto -2/z$ but unfortunately this does not normalise
$\Gamma_0(2)$. 
However it does normalise the \textit{anti Hecke congruencegroup}:
$$ \ah := \left \{ \begin{pmatrix} a & b \\ c & d \end{pmatrix} = 
\begin{pmatrix} 1 & 0 \\ * & 1 \end{pmatrix} \mod N \right \} < \g2.$$
The Hecke congruence group and the anti Hecke group are isomorphic
and in fact $z\mapsto -1/z$ conjugates them  in $\Gamma$  .
We can determine the orbits of this group on $\QQ$ using this
conjugation and we have:
$$\ah \{\infty\} =   \Gamma(2) \{\infty\} \cup \Gamma(2) \{1\}.$$

\subsection{Canonical cusp regions}\label{canonical cusp}

We denote by $F$ the set  $\{ z, \im z > 1\}$
this is a \textit{horoball in $\HH$} centered at $\infty$.
The image of $F$ under the $\sl2$ action consists of
$F$ and infinitely many disjoint circles, the so-called \textit{Ford circles}, 
each tangent to the real line at some rational $m/n$.
We adopt the convention that $F$ is also a Ford circle of infinite radius.
If $G < \sl2$ is any finite index subgroup then 
each Ford circle projects to a cusp region on $\mathbb{H}/G$ and we
call this system  the \textit{canonical system of cusp regions}.

\begin{figure}[H]
\begin{center}
\includegraphics[scale=.8]{Ford-circles.png} 
\end{center}
\caption{Ford circles with tangent points and curvatures.
Recall that the curvature of a euclidean circle is the reciprocal of its radius.}
\end{figure}

The following is well known and is easily checked:

\begin{lem}\label{ford}
The Ford circle tangent to the real line at $m/n$
has Euclidean diameter $1/n^2$.
\end{lem}

\begin{coro}
	The $\lambda$-length of the arc joining 
	$a/c, b/d \in \mathbb{Q}$ is the absolute value of
	the determinant of the associated matrix 
	$$A= \begin{pmatrix} a& b\\c&d \end{pmatrix}.$$
\end{coro}

\proof There exists  $b'\in \mathbb{Z}$ and  a matrix $A' \in \sl2$ such that the product $A'A$
is an upper triangular matrix:
	$$A'A= \begin{pmatrix} 1& b'\\0& \det A
	\end{pmatrix}.$$
The image of $a/c$ under the Mobius transformation associated to
$A'$ is $\infty$ and the image of $b/d$ is $b'/\det A$.
The Ford circle at $\infty$ is $F$ and the 
diameter of the circle tangent at $b'/\det A$ is $(\det A)^2$.

\hfill $\Box$

  \begin{figure}[H]
	  \label{cusp regions}
\begin{center}
\includegraphics[scale=.5]{hecke_cover.png} 
\end{center}
\caption{On the left $\xx$ with the cusp regions inherited from the
Ford circles  $\mathbb{H}$.
On the right $\oot$ with the unmodified cusp regions.}
\end{figure}
\subsection{Cusp regions  on $\oot$}

The canonical system on $\xx$ consists of three cusp regions 
one for each of the three cusps $0,1,\infty$.
The map $z\mapsto z/z+1$ fixes $0$ and normalises $\g2$,
so induces an automorphism, in fact an involution of $\xx$ which
fixes the cusp labeled $0$.
The quotient of $\xx$ by the involution is naturally identified with
the surface $\oot$
inherits a system of cusp regions from $\xx$ via the quotient map.
The involution $z\mapsto -2/z$ normalises $\ah$ so induces an
automorphism of $\oot$ which fixes the points labelled
$1+i$ and $i\sqrt 2$, swaps the cusps labelled
$\frac{1}{0}$ and
$\frac{0}{1}$ but which does not swap the cusp regions inherited
from $\xx$.
In fact a computation shows that the cusp region for $\frac{1}{0}$ has
area $2$ whilst the cusp region for $\frac{0}{1}$ has area $1$.
We remedy this by choosing a pair of cusp regions which are tangent
at the fixed point of the automorphism and which both have area $\sqrt 2$.
To do this 
\begin{itemize}
\item the cusp region for $1/0$ shrinks by a factor of
$\sqrt 2$ 
\item whilst the cusp region for $0/1$ expands by $\sqrt 2$.
\end{itemize}
The lifts of this modified pair of cusp regions to $\HH$ form a family of circles each of which, like the Ford
circles, is tangent to the real line at a rational
$\frac{m}{n}\in \mathbb{Q}$.
However, the diameter of the circle tangent at $m/n$ is no longer
$\frac{1}{n^2}$ as in Lemma \ref{ford} rather we have:

\begin{lem}\label{new diameters}
	The diameter of the circle tangent at $m/n$:

\begin{itemize}
	\item $\sqrt 2 \times 1/ n^2$ if $m$ is even.
	\item $1/\sqrt 2 \times 1 / n^2$ if $m$ is odd.
\end{itemize}
\end{lem}

 \begin{figure}[H]
\begin{center}
\includegraphics[scale=1]{farey_mod.png} 
\end{center}
\caption{Modified Farey circles}
\label{modified farey}
\end{figure}

\subsection{Arcs on $\oot$}

The surface has two cusps and so there are two kind of arc
\begin{itemize}
	\item arcs that join distinct cusps $0/1$ and $1/0$
	\item arcs that have both ends at the same either
		cusps $0/1$ or $1/0$.
\end{itemize}
It follows from Lemma \ref{new diameters}:

\begin{lem}\label{new lambdas}
Arcs of the first kind,
that is those which join distinct cusps $0/1$ and $1/0$,
have the same $\lambda$-length for the inherited
cusp regions and our modified cusp regions. 
\end{lem}


Now any arc of the first kind lifts to a vertical line ending at
some rational $\frac{m}{n}\in \QQ$.
For each  $p>2$  prime 
the projections to $\oot$ of the Poincaré geodesics  $\infty,
\frac{2k}{p}$ with  $k = 1,2\ldots p-1$
are distinct arcs of the first kind 
and each of these has $\lambda$-length $p$ for our choice of cusp
regions:

\begin{coro}\label{hecke lambda lengths}
	
	If $p$ is an odd prime then there are exactly
	$p-1$ arcs of $\lambda$-length $p$.
\end{coro}

Since our involution swaps cusps only arcs of the first  kind can be invariant for it.


\begin{thm}
	If $p$ is a prime of the form $8k+3$ 
	then there are integers $x,y$ such that
	$$p = x^2 + 2 y^2.$$
\end{thm}

\proof As  before we consider an action of a Klein four group,
that is the automorphisms of the surface $\mathbb{H}/\Gamma_0(2)$,
on a set $X$ of cardinality $p-1$ namely the set of arcs of the first
kind having $\lambda$-length $p$.

Under the hypothesis the 
orientation reversing involutions
induced by the inversions in the circles
fix no elements of $X$ so the Burnside formula gives:
$$4 |X/G|   = (p-1) +  |X^g|,$$
where $g$ denotes the orientation preserving involution.
Now $p-1$ is congruent to $2$ modulo $4$ so $|X^g|$ 
is too and $g$ fixes an arc.

\hfill $\Box$

\section{Lifting involutions}\label{lifting involutions}

In order to simplify the  exposition we suppose that $p$ is a prime
and $m<p$ a square free integer such that $p-1$ is divisible by $m$.
Note that if $m=2$ then this condition is essentially trivial.


Let $\GG$ denote the set of $p-1$ arcs joining $\infty$ and $\frac{mk}{p}$
where $1\leq k < p$.
These arcs project to pairwise distinct arcs
of $\lambda$-length $p$ on the surface
$\mathbb{H}/\Gamma_0(m)$.
There is a natural bijection
taking an arc to the congruence class of the denominator modulo $p$:
\begin{eqnarray*}
	\pi:\GG& \rightarrow & \fp \\
	mk : & \mapsto& \overline{mk}.
\end{eqnarray*}
Evidently, since $\pi$ is a bijection any map $f:\fp\rightarrow	\fp$
lifts to a map of $\GG$
\[
\xymatrix{
\GG \ar[r]^{F} \ar[d]_{\pi} & \GG \ar[d]^{\pi} \\
\fp \ar[r]^{f} & \fp
}
\]	
and an obvious question is:
when does an automorphism $f$ of $\fp$
lift to an automorphism of the quotient surface?

% Equivalently, given an involution of $\mathbb{H}/\Gamma_0(m)$ does it induce an

% To make this precise let us represent each arc as a matrix,
% an involution of $\mathbb{H}$ $\frac{az+b}{cz+d}$
% induces a map of $\GG$ if there is an element $\frac{a'z+b'}{c'z+d'}$ of $\Gamma^t_0(m)$
% such that:

% $$
% \begin{pmatrix}
% a'& b' \\
% c' & d'
% \end{pmatrix}
% \begin{pmatrix}
% a& b \\
% c & d
% \end{pmatrix}
% \begin{pmatrix}
% mk& 1 \\
% p & 0
% \end{pmatrix} \sim 
% \begin{pmatrix}
% 1& mk' \\
% 0 & p
% \end{pmatrix}
% $$


In particular we wish to show that the 
three involutions
\begin{itemize}
	\item $z\mapsto - \bar{z}$ 
	\item $z\mapsto \frac{m}{\bar{z}}$ 
	\item $z\mapsto \frac{-m}{z}$ 
\end{itemize}
satisfy
\begin{enumerate}

	\item induce involutions of $\GG$,
	\item these maps lift the corresponding
	involutions on $\fp$ (see Lemma \ref{actions agree}
	below).

\end{enumerate}
This second point extends the calculation in the previous section
\ref{real part}.
The first of our involutions $z\mapsto\bar{z}$ 
is easily dealt with since $-(mk) = m(-k)$.
The third is the composition of the first and the second,
so it suffices to prove (1) and (2) for $z\mapsto \frac{m}{\bar{z}}$
.

\subsection{Some matrix algebra}

Since $k$ and $p$ are coprime there is a Bezout identity,
that is there are integers $k',p'$ such that,
$$k'k + p'p = 1$$
Note that we may replace the pair $k',p'$
by another pair $k'+ rp, p' -rk$ for any integer $r$
and, by chosing $r$ suitably,
may assume that $k'$ is divisible by $m$.
This observation allows us to define maps on $\GG$ as follows.
The map 
$z\mapsto \frac{m}{\bar{z}}$ is an inversion in the half circle
with end points $\pm\sqrt{m}$  and is 
is represented by the matrix
$$
\begin{pmatrix}
	0 & m \\ 1 & 0
\end{pmatrix}
$$
The image of the arc $\infty,\frac{mk}{p}$
under this map is $0, \frac{p}{k}$
and we have the equation

\begin{equation}
\begin{pmatrix}
	0 & m \\ 1 & 0
\end{pmatrix}
\begin{pmatrix}
mk & 1 \\
p & 0
\end{pmatrix}
= 
\begin{pmatrix}
mp & 0 \\
mk  & 1
\end{pmatrix}
\sim
\begin{pmatrix}
p & 0 \\
k & 1
\end{pmatrix}
\end{equation}

Consider the matrix identity
\begin{equation}
\begin{pmatrix}
p' & k' \\
-k & p
\end{pmatrix}
\begin{pmatrix}
p & 0 \\
k & 1
\end{pmatrix}
= 
\begin{pmatrix}
1 & k' \\
0  & p
\end{pmatrix}
\end{equation}
This last matrix represents 
the arc joining $\infty$ to $k'/p$ 
and, since $k'$ is divisible $m$,
this is an element of $\GG$.
Thus we may define a map $\GG  \rightarrow \GG $ that takes the arc $\infty, \frac{mk}{p}$ to $\infty,
	\frac{k'}{p}$.
Note further that, 
since $ p =  1 \mod m$,
$$
\begin{pmatrix}
p' & k' \\
-k & p
\end{pmatrix}
\in \Gamma^t _0(m)$$
so this map induces a map on the arcs on the quotient surface
$\mathbb{H}/\Gamma^t_0(m)$.




\begin{thm} \label{actions agree}
	
Let $f$ denote the involution on $\fp $ defined by $ x \mapsto mx^{-1}$ 
and $F$ the map described above then 
$$ f(\overline{mk}) = \overline{F(mk)}.$$
\end{thm}

\proof
This follows from the observation that on reducing the Bezout
identity modulo $p$ one has
$$\bar{1} = \overline{k'k} + \overline{p'p}=  \overline{k'}\overline{k} $$
so that $\overline{k}^{-1} = \overline{k'}.$
\hfill $\Box$

\begin{coro}
There is an involution of $\GG$ that lifts the involution 
$\bar{x} \mapsto -m\bar{x}^{-1}$ on $\fp$.
\end{coro}
\proof The involution in question is the composition of a pair of
involutions that lift. 
One obtains the required lift $G$ as the composition of the lifts of
these involutions. 
\hfill $\Box$

\subsection{Explicit formulas for square roots in $\fp$}

In many cases one can find a formula for the square root of a
quadratic residue modulo $p$.
\begin{itemize}
	\item If $p = 1 \mod 4$ then, by Wilson's theorem
		$\left(\frac{p-1}{2}\right)!$ is a square root of $-1$
	\item If $p = 1 \mod 4$ and $x$ is a solution of the
		equation
		$X^4+1 = 0$ then $x^2 + x^{-2}=0$
		and $(x\pm x^{-1})^2 = \pm 2$
	
	\item If $p = 1 \mod 6$ and $x$ is a solution of the
		equation
		$X^6+1 = 0$ then $x^3 + x^{-3}=0$
		and, expanding  $(x\pm x^{-1})^3$
		using the binomial formula, one has
		$(x\pm x^{-1})^2 = \pm 3$
	\item If $p = 3 \mod 4$ and $x$ a quadratic residue
		then $x^\frac{p+1}{2}$ is a square root of
		$x$.
		
\end{itemize}

\thebibliography{99}

% \bibitem{aigner}
% M. Aigner
% \textit{Markov's Theorem and 100 Years of the Uniqueness Conjecture}, Springer( 2013)

\bibitem{aigner2}
Aigner M., Ziegler G.M.  
\textit{Representing numbers as sums of two squares.} In: Proofs from the book. Springer, Berlin, Heidelberg. (2010)

% \bibitem{barag}
% A. Baragar,
% \textit{On the Unicity Conjecture for Markoff Numbers}
% Canadian Mathematical Bulletin , Volume 39 , Issue 1 , 01 March 1996 , pp. 3 - 9

\bibitem{button}
J. O. Button, 
\textit{The uniqueness of the prime Markoff numbers},
 J. London Math. Soc.
(2) 58 (1998), 9–17.

\bibitem{frieze}
Ilke Canakci, Anna Felikson, Ana Garcia Elsener, Pavel Tumarkin,
\textit{Friezes for a pair of pants},
Proceedings of the Formal Power Series and Algebraic Combinatorics 2022 - Séminaire Lotharingien de Combinatoire

% \bibitem{cana}
% Ilke Canakci, Ralf Schiffler
% \textit{Snake graphs and continued fractions}
% European Journal of Combinatorics
% Volume 86, May 2020, 103081
\bibitem{conway}
John Horton Conway
\textit{The Sensual Quadratic Form}
Carus Mathematical Monographs
Volume: 26
1997

\bibitem{cox}
 D. A. Cox, Primes of the Forms $x^2 + ny^2$
: Fermat, Class Field Theory, and
Complex Multiplication, John Wiley, New York, 1989.

\bibitem{dolan}
Dolan, S., 
\textit{A very simple proof of the two-squares theorem.}
The Mathematical Gazette, 106(564), 511-511. (2021) doi:10.1017/mag.2021.120
% https://www.cambridge.org/core/journals/mathematical-gazette/article/abs/10538-a-very-simple-proof-of-the-twosquares-theorem/D0CB1CB39CBA0E98905401EA21DCB743

\bibitem{dubach}
Guillaume Dubach, Fabian Muehlboeck
Formal verification of Zagier's one-sentence proof
\url{https://arxiv.org/abs/2103.11389}

\bibitem{elsholtz}
Elsholtz C.A 
\textit{Combinatorial Approach to Sums of Two Squares and Related Problems.}
 In: Chudnovsky D., Chudnovsky G. (eds) Additive Number Theory. Springer, New York, NY.
 (2010) 

\bibitem{fomin}
S. Fomin and D. Thurston,
\textit{Cluster algebras and triangulated surfaces}
Part II: Lambda lengths, \url{arXiv:1210.5569v1.}

\bibitem{ford}
Lester R Ford,
\textit{Automorphic Functions}

\bibitem{generalov}
Generalov, A.I. 
\textit{A combinatorial proof of Euler-Fermat’s theorem on the representation of the primes p=8k+3 by the quadratic
form $x^2 + 2y^2$. }
J Math Sci 140, 690–691 (2007). https://doi.org/10.1007/s10958-007-0008-6

\bibitem{hatcher}

Allen Hatcher, 
\textit{Topology of Numbers} 
American Mathematical Society.
2022
\url{https://pi.math.cornell.edu/~hatcher/TN/TNbook.pdf}


\bibitem{heath}
Heath-Brown, Roger. 
\textit{ Fermat’s two squares theorem.} Invariant (1984) 

\bibitem{herriot}
Neil Herriot, Communication with Jim Propp
\url{https://faculty.uml.edu/jpropp/reach/Herriot/ptolemywriteup.html}

\bibitem{jackson}
Jackson, Terence H.. “A Short Proof That Every Prime $p = 3 \mod 8$ Is of the Form $x^2 + 2y^2$.” The American Mathematical Monthly 107 (2000): 447 - 447.


% \bibitem{mong}
% M.L. Lang, S.P Tan,
% \textit{A simple proof of the Markoff conjecture for prime powers}
% Geometriae Dedicata volume 129, pages15–22 (2007)


\bibitem{thesis}
G. McShane,
\textit{Simple geodesics and a series constant over Teichmuller space}
Invent. Math. (1998)

\bibitem{vlad}
Greg McShane, Vlad Sergiescu,
\textit{Geometry of Fermat's sum of squares}

\bibitem{northshield}
Northshield, Sam. 
\textit{A Short Proof of Fermat’s Two-square Theorem.} The American Mathematical Monthly. 127. 638-638. (2020). 


\bibitem{bob}
R. C. Penner, 
\textit{The decorated Teichmueller space of punctured surfaces}, 
Communications in Mathematical Physics 113 (1987), 299–339.

% \bibitem{propp}
% James Propp,
% The combinatorics of frieze patterns and Markoff numbers,
% \url{https://arxiv.org/abs/math/0511633}

\bibitem{propp}
James Propp,
The combinatorics of frieze patterns and Markoff numbers,
in  Integers, Volume 20 (2020)
\url{http://math.colgate.edu/~integers/u12/u12.pdf}


\bibitem{serre}
J-P. Serre,
\textit{A Course in Arithmetic},
Graduate Texts in Mathematics,
Springer-Verlag New York
1973

\bibitem{Shimizu}
H. Shimizu, 
\textit{On discontinuous groups operating on the product of half spaces}, Ann. of Math. (2)77(1963), 33-71.


\bibitem{springborn1}

B. Springborn. The hyperbolic geometry of Markov’s theorem on Diophantine
approximation and quadratic forms. Enseign. Math., 63(3-4):333–373, 2017.

\bibitem{springborn2}
Boris Springborn,
\textit{The worst approximable rational numbers}
\url{https://arxiv.org/abs/2209.15542}


% \bibitem{saw}
% Scott Wolpert,
% \textit{On the Kahler form of the moduli space of once-punctured tori}, 
% Comment. Math. Helv. 58(1983)246-256

\bibitem{zagier}
D. Zagier,
 \textit{A one-sentence proof that every prime p = 1 (mod 4) is a sum of two squares}, 
 American Mathematical Monthly, 97 (2): 144
 
\bibitem{zhang3}
Ying Zhang
\textit{Representing Primes as $x^2 + 5y^2$: An Inductive Proof that Euler Missed}
\url{https://arxiv.org/abs/math/0606547}


 % \bibitem{zhang}
 % Y. Zhang,
 % \textit{ An elementary proof of uniqueness of Markoff numbers}
 % preprint, arXiv:math.NT/0606283
 
  % \bibitem{zhang2}
  %  Y. Zhang,
 % \textit{Congruence and uniqueness of certain Markoff numbers}
 % Acta Arithmetica, Volume: 128, Issue: 3, page 295-301

\end{document}
